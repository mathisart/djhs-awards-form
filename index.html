<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>çæ‡²åå–®å¡«å ±èˆ‡æ–‡ä»¶è‡ªå‹•ç”¢å‡ºç³»çµ±</title>
  <style>
    :root{
      --line:#e5e7eb; --muted:#6b7280; --text:#111827; --bg:#fafafa; --ok:#10b981; --bad:#ef4444; --primary:#2563eb;
    }
    *{box-sizing:border-box}
    body{font-family:system-ui,-apple-system,"Microsoft JhengHei",sans-serif;margin:0;background:#fff;color:var(--text)}
    .wrap{max-width:1200px;margin:40px auto;padding:0 20px}
    h1{font-size:20px;margin:0 0 16px}
    .grid{display:grid;gap:20px;grid-template-columns:360px 1fr}
    .card{border:1px solid var(--line);border-radius:12px;background:#fff}
    .card .hd{padding:16px 20px;border-bottom:1px solid var(--line);display:flex;justify-content:space-between;align-items:center}
    .card .bd{padding:20px}
    .status{padding:8px 12px;border-radius:999px;font-size:13px}
    .ok{background:#ecfdf5;color:#065f46;border:1px solid #a7f3d0}
    .bad{background:#fef2f2;color:#991b1b;border:1px solid #fecaca}
    .field{margin-bottom:14px}
    .lbl{display:block;margin-bottom:6px;color:var(--muted);font-size:13px}
    input[type="text"],input[type="number"],input[type="date"],select,textarea{
      width:100%;padding:10px 12px;border:1px solid var(--line);border-radius:10px;font:inherit;outline:none;
    }
    textarea{min-height:88px;resize:vertical}
    .row{display:flex;gap:10px}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:6px;padding:10px 14px;border:1px solid var(--line);border-radius:10px;background:#fff;cursor:pointer}
    .btn.primary{background:var(--primary);border-color:var(--primary);color:#fff}
    .btn.ghost{background:#fff}
    .btn.small{padding:8px 10px;font-size:14px}
    .actions{display:flex;gap:10px;align-items:center}
    .searchRow{display:flex;gap:10px;align-items:center}
    .searchRow input{flex:1}

    table{width:100%;border-collapse:collapse}
    th,td{padding:12px 10px;border-bottom:1px solid var(--line);text-align:left}
    th{color:#374151;font-weight:600;background:#fafafa}
    td.mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New",monospace;color:#374151}
    .empty{color:var(--muted);padding:20px 0}

    /* Modal */
    #backdrop{display:none;position:fixed;inset:0;background:rgba(0,0,0,.35);align-items:center;justify-content:center;padding:20px;z-index:50}
    .modal{width:min(760px,100%);background:#fff;border-radius:14px;border:1px solid var(--line);box-shadow:0 10px 30px rgba(0,0,0,.1);display:flex;flex-direction:column}
    .modal .mh{padding:14px 16px;border-bottom:1px solid var(--line);display:flex;align-items:center;justify-content:space-between}
    .modal .mb{padding:16px;max-height:60vh;overflow:auto;line-height:1.9}
    .modal .mf{padding:12px 16px;border-top:1px solid var(--line);display:flex;gap:8px;justify-content:flex-end}
    .muted{color:var(--muted);font-size:13px}
    .tag{display:inline-block;padding:2px 8px;border:1px solid var(--line);border-radius:999px;color:#374151;background:#f9fafb;font-size:12px}
    @media(max-width:900px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>ğŸ… çæ‡²åå–®å¡«å ±èˆ‡æ–‡ä»¶è‡ªå‹•ç”¢å‡ºç³»çµ±</h1>

    <div class="grid">
      <!-- å·¦ï¼šè¡¨å–® -->
      <div class="card">
        <div class="hd">
          <div>æ–°å¢ç²çåŒå­¸</div>
          <div id="topWarn" class="status bad">å¾Œç«¯é€£ç·šå¤±æ•—</div>
        </div>
        <div class="bd">
          <form id="form">
            <div class="field">
              <span class="lbl">ç­ç´š</span>
              <input type="text" name="ç­ç´š" placeholder="ä¾‹å¦‚ï¼š701" required />
            </div>
            <div class="field">
              <span class="lbl">åº§è™Ÿ</span>
              <input type="number" name="åº§è™Ÿ" placeholder="ä¾‹å¦‚ï¼š15" required />
            </div>
            <div class="field">
              <span class="lbl">å§“å</span>
              <input type="text" name="å§“å" placeholder="ä¾‹å¦‚ï¼šç‹å°æ˜" required />
            </div>
            <div class="field">
              <span class="lbl">ç™¼ç”Ÿæ—¥æœŸ</span>
              <input type="date" name="ç™¼ç”Ÿæ—¥æœŸ" required />
            </div>
            <div class="field">
              <span class="lbl">äº‹ç”±ï¼ˆç²çåŸå› ï¼æ¯”è³½åç¨±ï¼‰</span>
              <textarea name="äº‹ç”±" placeholder="ä¾‹å¦‚ï¼šè‹±èªæœ—è®€æ¯”è³½"></textarea>
            </div>
            <div class="field">
              <span class="lbl">æˆç¸¾ï¼ˆåæ¬¡/ç­‰ç¬¬ï¼‰</span>
              <input type="text" name="æˆç¸¾" placeholder="ä¾‹å¦‚ï¼šç¬¬ä¸€åã€ç¬¬äºŒåã€ç‰¹å„ªã€å„ªç­‰ã€ä½³ä½œâ€¦" />
            </div>
            <div class="field">
              <span class="lbl">çæ‡²ç¨®é¡ï¼ˆåƒ…ç”¨æ–¼æ•˜çå–®ï¼›å¸å„€ç¨¿ä¸ä½¿ç”¨ï¼‰</span>
              <select name="çæ‡²ç¨®é¡" id="awardSelect">
                <option value="">ï¼ˆä¸æ•˜çï¼‰</option>
                <option>å˜‰çä¸€æ”¯</option>
                <option>å˜‰çäºŒæ”¯</option>
                <option>å°åŠŸä¸€æ”¯</option>
                <option>å°åŠŸäºŒæ”¯</option>
              </select>
            </div>
            <div class="actions">
              <button type="submit" class="btn primary">ï¼‹åŠ å…¥åå–®</button>
            </div>
          </form>
        </div>
      </div>

      <!-- å³ï¼šåå–® -->
      <div class="card">
        <div class="hd">
          <div>å·²å¡«å ±åå–®ï¼ˆå…± <span id="count">0</span> ç­†ï¼‰</div>
          <div class="actions">
            <div class="searchRow">
              <input id="q" type="text" placeholder="æœå°‹ï¼šç­ç´š / å§“å / äº‹ç”± / æˆç¸¾" />
              <button id="refreshBtn" class="btn small">é‡æ–°æ•´ç†</button>
            </div>
          </div>
        </div>
        <div class="bd">
          <div class="actions" style="margin-bottom:10px;gap:12px">
            <button id="btnEmcee" class="btn">ä¸€éµç”¢å‡ºå¸å„€ç¨¿</button>
            <button id="btnAward" class="btn ghost">ä¸€éµç”¢å‡ºæ•˜çå–®</button>
            <span id="backendStatus" class="muted"></span>
          </div>

          <table>
            <thead>
              <tr>
                <th style="width:46px"><button id="toggleAllBtn" class="btn small">å…¨é¸/å–æ¶ˆ</button></th>
                <th class="mono">ç·¨è™Ÿ</th>
                <th>ç­ç´š</th>
                <th>åº§è™Ÿ</th>
                <th>å§“å</th>
                <th>æ—¥æœŸ</th>
                <th>äº‹ç”±</th>
                <th>æˆç¸¾</th>
                <th>çæ‡²ç¨®é¡</th>
                <th class="mono">å»ºç«‹æ™‚é–“</th>
              </tr>
            </thead>
            <tbody id="tbody"><tr><td colspan="10" class="empty">å°šç„¡è³‡æ–™</td></tr></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- å¸å„€ç¨¿ / PDF Modal -->
  <div id="backdrop">
    <div class="modal">
      <div class="mh">
        <div id="modalTitle">é è¦½</div>
        <button id="closeModal" class="btn small">é—œé–‰</button>
      </div>
      <div id="docBody" class="mb"></div>
      <div class="mf">
        <button id="copyBtn" class="btn">è¤‡è£½æ–‡å­—</button>
        <button id="downloadPdfBtn" class="btn">åŒ¯å‡ºPDF</button>
      </div>
    </div>
  </div>

  <!-- html2pdf -->
  <script defer src="https://cdn.jsdelivr.net/npm/html2pdf.js@0.10.1/dist/html2pdf.bundle.min.js"></script>
  <!-- config.jsï¼šåªæ”¾ Apps Script URL -->
  <script defer src="./config.js"></script>
  <!-- app.jsï¼šä¸»ç¨‹å¼ -->
  <script defer src="./app.js"></script>
</body>
</html>
